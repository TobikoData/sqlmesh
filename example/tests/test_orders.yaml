test_single_order:
  model: sushi.orders
  inputs:
    raw.orders:
      rows:
      - id: 1
        customer_id: 1
        waiter_id: 1
        start_ts: 2022-01-01 01:59:00
        end_ts: 2022-01-01 02:29:00
        ds: 2022-01-01
  outputs:
    vars:
      start: 2022-01-01
      end: 2022-01-01
      latest: 2022-01-01
    query:
      rows:
      - id: 1
        customer_id: 1
        waiter_id: 1
        start_ts: '2022-01-01 01:59:00'
        end_ts: '2022-01-01 02:29:00'
        ds: '2022-01-01'
test_multiple_orders:
  model: sushi.orders
  inputs:
    raw.orders:
      rows:
      - id: 1
        customer_id: 1
        waiter_id: 1
        start_ts: 2022-01-01 01:59:00
        end_ts: 2022-01-01 02:29:00
        ds: 2022-01-01
      - id: 2
        customer_id: 2
        waiter_id: 2
        start_ts: 2022-01-01 01:59:00
        end_ts: 2022-01-01 02:29:00
        ds: 2022-01-01
  outputs:
    vars:
      start: 2022-01-01
      end: 2022-01-01
      latest: 2022-01-01
    query:
      rows:
      - id: 1
        customer_id: 1
        waiter_id: 1
        start_ts: '2022-01-01 01:59:00'
        end_ts: '2022-01-01 02:29:00'
        ds: '2022-01-01'
      - id: 2
        customer_id: 2
        waiter_id: 2
        start_ts: '2022-01-01 01:59:00'
        end_ts: '2022-01-01 02:29:00'
        ds: '2022-01-01'

test_multiple_ds:
  model: sushi.orders
  inputs:
    raw.orders:
      rows:
      - id: 1
        customer_id: 1
        waiter_id: 1
        start_ts: 2022-01-01 01:59:00
        end_ts: 2022-01-01 02:29:00
        ds: 2022-01-01
      - id: 2
        customer_id: 2
        waiter_id: 2
        start_ts: 2022-01-02 01:59:00
        end_ts: 2022-01-02 02:29:00
        ds: 2022-01-02
  outputs:
    vars:
      start: 2022-01-01
      end: 2022-01-01
      latest: 2022-01-01
    query:
      rows:
      - id: 1
        customer_id: 1
        waiter_id: 1
        start_ts: '2022-01-01 01:59:00'
        end_ts: '2022-01-01 02:29:00'
        ds: '2022-01-01'
