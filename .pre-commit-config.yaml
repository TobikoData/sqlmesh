repos:
  - repo: local
    hooks:
      - id: ruff
        name: ruff
        entry: ruff check --force-exclude --fix --ignore E721 --ignore E741
        language: python
        types_or: [python, pyi]
        require_serial: true
        files: &files ^(sqlmesh/|sqlmesh_dbt/|tests/|web/|examples/|setup.py)
      - id: ruff-format
        name: ruff-format
        entry: ruff format --force-exclude --line-length 100
        language: python
        types_or: [python, pyi]
        require_serial: true
        files: *files
      - id: mypy
        name: mypy
        language: python
        entry: mypy
        additional_dependencies: [
          "mypy~=1.13.0",
          "pydantic>=2.0.0",
          "astor",
          "click",
          "croniter",
          "duckdb>=0.10.0,!=0.10.3",
          "dateparser<=1.2.1",
          "hyperscript>=0.1.0",
          "ipywidgets",
          "jinja2",
          "packaging",
          "pandas",
          "python-dotenv",
          "requests",
          "rich[jupyter]",
          "ruamel.yaml",
          "sqlglot[rs]~=27.8.0",
          "tenacity",
          "time-machine",
          "json-stream",
          "agate==1.7.1",
          "beautifulsoup4",
          "clickhouse-connect",
          "cryptography",
          "databricks-sql-connector",
          "dbt-bigquery",
          "dbt-core",
          "dbt-duckdb>=1.7.1",
          "dbt-snowflake",
          "dbt-athena-community",
          "dbt-clickhouse",
          "dbt-databricks",
          "dbt-redshift",
          "dbt-trino",
          "Faker",
          "google-auth",
          "google-cloud-bigquery",
          "google-cloud-bigquery-storage",
          "httpx",
          "pandas-stubs",
          "pre-commit",
          "psycopg2-binary",
          "PyAthena[Pandas]",
          "PyGithub>=2.6.0",
          "python-gitlab>=4.0.0",
          "pyodbc>=5.0.0",
          "pyperf",
          "pyspark~=3.5.0",
          "pytest",
          "pytest-asyncio",
          "pytest-mock",
          "pytest-retry",
          "pytest-xdist",
          "pytz",
          "redshift_connector",
          "ruff~=0.11.0",
          "snowflake-connector-python[pandas,secure-local-storage]>=3.0.2",
          "sqlalchemy-stubs",
          "trino",
          "types-croniter",
          "types-dateparser",
          "types-PyMySQL",
          "types-python-dateutil",
          "types-pytz",
          "types-requests==2.28.8",
          "typing-extensions",
          "pygls>=1.2.0,<2.0.0",
          "lsprotocol",
          "fastapi==0.115.5",
          "watchfiles>=0.19.0",
          "uvicorn[standard]==0.22.0",
          "sse-starlette>=0.2.2",
          "pyarrow",
          "starlette>=0.27.0",
          "httptools",
          "websockets"
        ]
        "types": [python]
        files: *files
        require_serial: true
        exclude: ^(tests/fixtures)
      - id: valid migrations
        name: valid migrations
        entry: tooling/validating_migration_numbers.sh
        language: system
        pass_filenames: false
