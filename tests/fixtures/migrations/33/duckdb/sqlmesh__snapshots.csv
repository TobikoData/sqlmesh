name,identifier,version,snapshot,kind_name
raw.demographics,1140349482,1271445562,"{""name"": ""raw.demographics"", ""fingerprint"": {""data_hash"": ""2505907372"", ""metadata_hash"": ""1382137008"", ""parent_data_hash"": ""0"", ""parent_metadata_hash"": ""0""}, ""node"": {""name"": ""raw.demographics"", ""project"": """", ""description"": ""Table containing demographics information"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""EXTERNAL""}, ""partitioned_by"": [], ""clustered_by"": [], ""columns"": {""customer_id"": ""INT"", ""zip"": ""TEXT""}, ""audits"": [], ""grains"": [], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""mapping_schema"": {}, ""source_type"": ""external""}, ""parents"": [], ""audits"": [], ""created_ts"": 1700274095397, ""updated_ts"": 1700274096394, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""1271445562"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",EXTERNAL
sushi.items,815328819,1038481865,"{""name"": ""sushi.items"", ""fingerprint"": {""data_hash"": ""2887398871"", ""metadata_hash"": ""399212896"", ""parent_data_hash"": ""0"", ""parent_metadata_hash"": ""0""}, ""node"": {""name"": ""sushi.items"", ""project"": """", ""start"": ""1 week ago"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": """", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 30, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""depends_on"": [], ""columns"": {""id"": ""INT"", ""name"": ""TEXT"", ""price"": ""DOUBLE"", ""ds"": ""TEXT""}, ""audits"": [[""accepted_values"", {""column"": ""name"", ""is_in"": ""ARRAY('Ahi', 'Aji', 'Amaebi', 'Anago', 'Aoyagi', 'Bincho', 'Katsuo', 'Ebi', 'Escolar', 'Hamachi', 'Hamachi Toro', 'Hirame', 'Hokigai', 'Hotate', 'Ika', 'Ikura', 'Iwashi', 'Kani', 'Kanpachi', 'Maguro', 'Saba', 'Sake', 'Sake Toro', 'Tai', 'Tako', 'Tamago', 'Tobiko', 'Toro', 'Tsubugai', 'Umi Masu', 'Unagi', 'Uni')""}], [""not_null"", {""columns"": ""ARRAY(name, price)""}], [""assert_items_price_exceeds_threshold"", {""price"": ""0""}]], ""grains"": [], ""references"": [], ""hash_raw_query"": false, ""session_properties"": ""('string_prop' = 'some_value', 'int_prop' = 1, 'float_prop' = 1.0, 'bool_prop' = TRUE)"", ""allow_partials"": false, ""signals"": [], ""python_env"": {""execute"": {""payload"": ""def execute(context, start, end, execution_time, **kwargs):\n    dfs = []\n    for dt in iter_dates(start, end):\n        num_items = random.randint(10, len(ITEMS))\n        dfs.append(pd.DataFrame({'name': random.sample(ITEMS, num_items),\n            'price': np.random.uniform(3.0, 10.0, size=num_items).round(2),\n            'ds': to_ds(dt)}).reset_index().rename(columns={'index': 'id'}))\n    return pd.concat(dfs)"", ""kind"": ""definition"", ""name"": ""execute"", ""path"": ""models/items.py""}, ""iter_dates"": {""payload"": ""def iter_dates(start, end):\n    for i in range((end - start).days + 1):\n        dt = start + timedelta(days=i)\n        set_seed(dt)\n        yield dt"", ""kind"": ""definition"", ""name"": ""iter_dates"", ""path"": ""helper.py""}, ""timedelta"": {""payload"": ""from datetime import timedelta"", ""kind"": ""import""}, ""set_seed"": {""payload"": ""def set_seed(dt):\n    ts = int(dt.timestamp())\n    random.seed(ts)\n    np.random.seed(ts)"", ""kind"": ""definition"", ""name"": ""set_seed"", ""path"": ""helper.py""}, ""random"": {""payload"": ""import random"", ""kind"": ""import""}, ""np"": {""payload"": ""import numpy as np"", ""kind"": ""import""}, ""ITEMS"": {""payload"": ""['Ahi', 'Aji', 'Amaebi', 'Anago', 'Aoyagi', 'Bincho', 'Katsuo', 'Ebi', 'Escolar', 'Hamachi', 'Hamachi Toro', 'Hirame', 'Hokigai', 'Hotate', 'Ika', 'Ikura', 'Iwashi', 'Kani', 'Kanpachi', 'Maguro', 'Saba', 'Sake', 'Sake Toro', 'Tai', 'Tako', 'Tamago', 'Tobiko', 'Toro', 'Tsubugai', 'Umi Masu', 'Unagi', 'Uni']"", ""kind"": ""value""}, ""pd"": {""payload"": ""import pandas as pd"", ""kind"": ""import""}, ""to_ds"": {""payload"": ""from sqlmesh.utils.date import to_ds"", ""kind"": ""import""}}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""mapping_schema"": {}, ""entrypoint"": ""execute"", ""source_type"": ""python""}, ""parents"": [], ""audits"": [{""name"": ""assert_items_price_exceeds_threshold"", ""dialect"": ""duckdb"", ""skip"": false, ""blocking"": true, ""standalone"": false, ""query"": ""SELECT *\nFROM @this_model\nWHERE price <= @price;"", ""defaults"": {}, ""expressions"": [], ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}}], ""created_ts"": 1700274095400, ""updated_ts"": 1700274096396, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""1038481865"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.orders,2312765867,1740723439,"{""name"": ""sushi.orders"", ""fingerprint"": {""data_hash"": ""1341598154"", ""metadata_hash"": ""2952531836"", ""parent_data_hash"": ""0"", ""parent_metadata_hash"": ""0""}, ""node"": {""name"": ""sushi.orders"", ""project"": """", ""description"": ""Table of sushi orders."", ""start"": ""1 week ago"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": """", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 30, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""depends_on"": [], ""columns"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""TEXT""}, ""audits"": [], ""grains"": [""id AS order_id""], ""references"": [""customer_id"", ""waiter_id""], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {""execute"": {""payload"": ""def execute(context, start, end, execution_time, **kwargs):\n    dfs = []\n    for dt in iter_dates(start, end):\n        num_orders = random.randint(10, 30)\n        start_ts = [int((dt + timedelta(seconds=random.randint(0, 80000))).\n            timestamp()) for _ in range(num_orders)]\n        end_ts = [int(s + random.randint(0, 60 * 60)) for s in start_ts]\n        dfs.append(pd.DataFrame({'customer_id': random.choices(CUSTOMERS, k\n            =num_orders), 'waiter_id': random.choices(WAITERS, k=num_orders\n            ), 'start_ts': start_ts, 'end_ts': end_ts, 'ds': to_ds(dt)}).\n            reset_index().rename(columns={'index': 'id'}))\n    return pd.concat(dfs)"", ""kind"": ""definition"", ""name"": ""execute"", ""path"": ""models/orders.py""}, ""iter_dates"": {""payload"": ""def iter_dates(start, end):\n    for i in range((end - start).days + 1):\n        dt = start + timedelta(days=i)\n        set_seed(dt)\n        yield dt"", ""kind"": ""definition"", ""name"": ""iter_dates"", ""path"": ""helper.py""}, ""timedelta"": {""payload"": ""from datetime import timedelta"", ""kind"": ""import""}, ""set_seed"": {""payload"": ""def set_seed(dt):\n    ts = int(dt.timestamp())\n    random.seed(ts)\n    np.random.seed(ts)"", ""kind"": ""definition"", ""name"": ""set_seed"", ""path"": ""helper.py""}, ""random"": {""payload"": ""import random"", ""kind"": ""import""}, ""np"": {""payload"": ""import numpy as np"", ""kind"": ""import""}, ""pd"": {""payload"": ""import pandas as pd"", ""kind"": ""import""}, ""CUSTOMERS"": {""payload"": ""[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]"", ""kind"": ""value""}, ""WAITERS"": {""payload"": ""[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]"", ""kind"": ""value""}, ""to_ds"": {""payload"": ""from sqlmesh.utils.date import to_ds"", ""kind"": ""import""}}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""mapping_schema"": {}, ""entrypoint"": ""execute"", ""source_type"": ""python""}, ""parents"": [], ""audits"": [], ""created_ts"": 1700274095398, ""updated_ts"": 1700274096398, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""1740723439"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.raw_marketing,462154728,3933936918,"{""name"": ""sushi.raw_marketing"", ""fingerprint"": {""data_hash"": ""1565231844"", ""metadata_hash"": ""1096964904"", ""parent_data_hash"": ""0"", ""parent_metadata_hash"": ""0""}, ""node"": {""name"": ""sushi.raw_marketing"", ""project"": """", ""description"": ""Table of marketing status."", ""start"": ""1 week ago"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": """", ""kind"": {""name"": ""FULL""}, ""partitioned_by"": [], ""clustered_by"": [], ""depends_on"": [], ""columns"": {""customer_id"": ""INT"", ""status"": ""TEXT"", ""updated_at"": ""TIMESTAMP""}, ""audits"": [], ""grains"": [""customer_id""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {""execute"": {""payload"": ""def execute(context, end, execution_time, **kwargs):\n    existing_table = context.table('sushi.raw_marketing')\n    df_existing = context.fetchdf(\n        f'SELECT customer_id, status, updated_at FROM {existing_table}')\n    seed = int(end.strftime('%Y%m%d'))\n    np.random.seed(seed)\n    num_customers = random.randint(30, 100)\n    df_new = pd.DataFrame({'customer_id': random.sample(range(0, 100), k=\n        num_customers), 'status': np.random.choice(['active', 'inactive'],\n        size=num_customers, p=[0.8, 0.2]), 'updated_at': [execution_time] *\n        num_customers})\n    df = df_new.merge(df_existing, on='customer_id', how='left', suffixes=(\n        None, '_old'))\n    df['updated_at'] = pd.to_datetime(np.where(df['status_old'] != df[\n        'status'], execution_time, df['updated_at_old']), errors='coerce')\n    df = df.drop(columns=['status_old', 'updated_at_old'])\n    return df"", ""kind"": ""definition"", ""name"": ""execute"", ""path"": ""models/raw_marketing.py""}, ""np"": {""payload"": ""import numpy as np"", ""kind"": ""import""}, ""random"": {""payload"": ""import random"", ""kind"": ""import""}, ""pd"": {""payload"": ""import pandas as pd"", ""kind"": ""import""}}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""mapping_schema"": {}, ""entrypoint"": ""execute"", ""source_type"": ""python""}, ""parents"": [], ""audits"": [], ""created_ts"": 1700274095398, ""updated_ts"": 1700274096399, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""3933936918"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",FULL
sushi.waiter_names,2187544572,235351925,"{""name"": ""sushi.waiter_names"", ""fingerprint"": {""data_hash"": ""2267718226"", ""metadata_hash"": ""1165429974"", ""parent_data_hash"": ""0"", ""parent_metadata_hash"": ""0""}, ""node"": {""name"": ""sushi.waiter_names"", ""project"": """", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""SEED"", ""path"": ""../seeds/waiter_names.csv"", ""batch_size"": 5}, ""partitioned_by"": [], ""clustered_by"": [], ""depends_on"": [], ""audits"": [], ""grains"": [""id""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {}, ""pre_statements"": [], ""post_statements"": [], ""seed"": {""content"": """"}, ""column_hashes"": {""id"": ""3679804453"", ""name"": ""537745575""}, ""is_hydrated"": false, ""source_type"": ""seed""}, ""parents"": [], ""audits"": [], ""created_ts"": 1700274095394, ""updated_ts"": 1700274096401, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""235351925"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",SEED
assert_item_price_above_zero,1891953054,4275433300,"{""name"": ""assert_item_price_above_zero"", ""fingerprint"": {""data_hash"": ""0"", ""metadata_hash"": ""1259873412"", ""parent_data_hash"": ""1774073423"", ""parent_metadata_hash"": ""128744526""}, ""node"": {""name"": ""assert_item_price_above_zero"", ""project"": """", ""description"": ""Asserts that the price of an item is above zero."", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""skip"": false, ""blocking"": false, ""standalone"": true, ""query"": ""SELECT *\nFROM sushi.items\nWHERE price <= 0"", ""defaults"": {}, ""expressions"": [], ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""hash_raw_query"": false, ""python_env"": {}, ""source_type"": ""audit""}, ""parents"": [{""name"": ""sushi.items"", ""identifier"": ""815328819""}], ""audits"": [], ""created_ts"": 1700274095400, ""updated_ts"": 1700274096402, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""4275433300"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",
sushi.marketing,4121597394,3476342839,"{""name"": ""sushi.marketing"", ""fingerprint"": {""data_hash"": ""1948418925"", ""metadata_hash"": ""699524351"", ""parent_data_hash"": ""2772737768"", ""parent_metadata_hash"": ""999531829""}, ""node"": {""name"": ""sushi.marketing"", ""project"": """", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""SCD_TYPE_2"", ""unique_key"": [""customer_id""], ""valid_from_name"": ""valid_from"", ""valid_to_name"": ""valid_to"", ""updated_at_name"": ""updated_at"", ""forward_only"": true, ""disable_restatement"": true}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [], ""grains"": [""customer_id""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""raw_marketing"": {""customer_id"": ""INT"", ""status"": ""TEXT"", ""updated_at"": ""TIMESTAMP""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""SELECT\n    customer_id::INT AS customer_id,\n    status::TEXT AS status,\n    updated_at::TIMESTAMP AS updated_at\nFROM\n    sushi.raw_marketing"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.raw_marketing"", ""identifier"": ""462154728""}], ""audits"": [], ""created_ts"": 1700274095364, ""updated_ts"": 1700274096403, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""3476342839"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",SCD_TYPE_2
sushi.order_items,2919798394,2384594262,"{""name"": ""sushi.order_items"", ""fingerprint"": {""data_hash"": ""4107649997"", ""metadata_hash"": ""960405399"", ""parent_data_hash"": ""3273282941"", ""parent_metadata_hash"": ""2410551213""}, ""node"": {""name"": ""sushi.order_items"", ""project"": """", ""cron"": ""@daily"", ""tags"": [], ""dialect"": """", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 30, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""depends_on"": [""sushi.orders"", ""sushi.items""], ""columns"": {""id"": ""INT"", ""order_id"": ""INT"", ""item_id"": ""INT"", ""quantity"": ""INT"", ""ds"": ""TEXT""}, ""audits"": [[""not_null"", {""columns"": ""ARRAY(id, order_id, item_id, quantity)""}], [""assert_order_items_quantity_exceeds_threshold"", {""quantity"": ""0""}]], ""grains"": [], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {""execute"": {""payload"": ""def execute(context, start, end, execution_time, **kwargs):\n    orders_table = context.table('sushi.orders')\n    items_table = context.table(ITEMS)\n    for dt in iter_dates(start, end):\n        orders = context.fetchdf(\n            f\""\""\""\n            SELECT *\n            FROM {orders_table}\n            WHERE ds = '{to_ds(dt)}'\n            \""\""\""\n            )\n        orders = orders.rename(columns={col: col.lower() for col in orders.\n            columns})\n        items = context.fetchdf(\n            f\""\""\""\n            SELECT *\n            FROM {items_table}\n            WHERE ds = '{to_ds(dt)}'\n            \""\""\""\n            )\n        items = items.rename(columns={col: col.lower() for col in items.\n            columns})\n        dfs = []\n        for order_id in orders['id']:\n            n = random.randint(1, 5)\n            dfs.append(pd.DataFrame({'order_id': order_id, 'item_id': items\n                .sample(n=n)['id'], 'quantity': np.random.randint(1, 10, n),\n                'ds': to_ds(dt)}).reset_index().rename(columns={'index': 'id'})\n                )\n        yield pd.concat(dfs)"", ""kind"": ""definition"", ""name"": ""execute"", ""path"": ""models/order_items.py""}, ""ITEMS"": {""payload"": ""'sushi.items'"", ""kind"": ""value""}, ""iter_dates"": {""payload"": ""def iter_dates(start, end):\n    for i in range((end - start).days + 1):\n        dt = start + timedelta(days=i)\n        set_seed(dt)\n        yield dt"", ""kind"": ""definition"", ""name"": ""iter_dates"", ""path"": ""helper.py""}, ""timedelta"": {""payload"": ""from datetime import timedelta"", ""kind"": ""import""}, ""set_seed"": {""payload"": ""def set_seed(dt):\n    ts = int(dt.timestamp())\n    random.seed(ts)\n    np.random.seed(ts)"", ""kind"": ""definition"", ""name"": ""set_seed"", ""path"": ""helper.py""}, ""random"": {""payload"": ""import random"", ""kind"": ""import""}, ""np"": {""payload"": ""import numpy as np"", ""kind"": ""import""}, ""to_ds"": {""payload"": ""from sqlmesh.utils.date import to_ds"", ""kind"": ""import""}, ""pd"": {""payload"": ""import pandas as pd"", ""kind"": ""import""}}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""TEXT""}, ""items"": {""id"": ""INT"", ""name"": ""TEXT"", ""price"": ""DOUBLE"", ""ds"": ""TEXT""}}}, ""entrypoint"": ""execute"", ""source_type"": ""python""}, ""parents"": [{""name"": ""sushi.orders"", ""identifier"": ""2312765867""}, {""name"": ""sushi.items"", ""identifier"": ""815328819""}], ""audits"": [{""name"": ""assert_order_items_quantity_exceeds_threshold"", ""dialect"": ""duckdb"", ""skip"": false, ""blocking"": true, ""standalone"": false, ""query"": ""SELECT *\nFROM @this_model\nWHERE quantity <= @quantity"", ""defaults"": {}, ""expressions"": [], ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}}], ""created_ts"": 1700274095397, ""updated_ts"": 1700274096404, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""2384594262"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.waiters,1434975336,47827067,"{""name"": ""sushi.waiters"", ""fingerprint"": {""data_hash"": ""623967540"", ""metadata_hash"": ""1778620661"", ""parent_data_hash"": ""788791158"", ""parent_metadata_hash"": ""2482667216""}, ""node"": {""name"": ""sushi.waiters"", ""project"": """", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""EMBEDDED""}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [], ""grains"": [], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {""entrypoint"": {""payload"": ""def entrypoint(evaluator):\n    excluded = {'id', 'customer_id', 'start_ts', 'end_ts'}\n    projections = []\n    for column, dtype in evaluator.columns_to_types('sushi.orders').items():\n        if column not in excluded:\n            projections.append(f'{column}::{dtype}')\n    return exp.select(*projections).from_('sushi.orders AS o').where(\n        incremental_by_ds(evaluator, exp.to_column('ds'))).distinct()"", ""kind"": ""definition"", ""name"": ""entrypoint"", ""path"": ""models/waiters.py""}, ""exp"": {""payload"": ""import sqlglot.expressions as exp"", ""kind"": ""import""}, ""incremental_by_ds"": {""payload"": ""def incremental_by_ds(evaluator, column):\n    return between(evaluator, column, evaluator.locals['start_ds'],\n        evaluator.locals['end_ds'])"", ""kind"": ""definition"", ""name"": ""incremental_by_ds"", ""path"": ""macros/macros.py""}, ""between"": {""payload"": ""def between(evaluator, value, start, end):\n    return value.between(start, end)"", ""kind"": ""definition"", ""name"": ""between"", ""path"": ""macros/utils.py""}}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""TEXT""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""@entrypoint()"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.orders"", ""identifier"": ""2312765867""}], ""audits"": [], ""created_ts"": 1700274095399, ""updated_ts"": 1700274096406, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""47827067"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",EMBEDDED
sushi.customer_revenue_by_day,3731921657,2415394817,"{""name"": ""sushi.customer_revenue_by_day"", ""fingerprint"": {""data_hash"": ""855071519"", ""metadata_hash"": ""764739230"", ""parent_data_hash"": ""1473581816"", ""parent_metadata_hash"": ""1029038200""}, ""node"": {""name"": ""sushi.customer_revenue_by_day"", ""project"": """", ""description"": ""Table of revenue from customers by day."", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [""expensive""], ""dialect"": ""hive"", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 10, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [], ""grains"": [""[customer_id, ds]""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""order_items"": {""id"": ""INT"", ""order_id"": ""INT"", ""item_id"": ""INT"", ""quantity"": ""INT"", ""ds"": ""STRING""}, ""items"": {""id"": ""INT"", ""name"": ""STRING"", ""price"": ""DOUBLE"", ""ds"": ""STRING""}, ""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""STRING""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""WITH order_total AS (\n  SELECT\n    oi.order_id AS order_id,\n    SUM(oi.quantity * i.price) AS total,\n    oi.ds AS ds\n  FROM sushi.order_items AS oi\n  LEFT JOIN sushi.items AS i\n    ON oi.item_id = i.id AND oi.ds = i.ds\n  WHERE\n    oi.ds BETWEEN '{{ start_ds }}' AND '{{ end_ds }}'\n  GROUP BY\n    oi.order_id,\n    oi.ds\n)\nSELECT\n  o.customer_id::INT AS customer_id, /* Customer id */\n  SUM(ot.total)::DOUBLE AS revenue, /* Revenue from orders made by this customer */\n  o.ds::TEXT AS ds /* Date */\nFROM sushi.orders AS o\nLEFT JOIN order_total AS ot\n  ON o.id = ot.order_id AND o.ds = ot.ds\nWHERE\n  o.ds BETWEEN '{{ start_ds }}' AND '{{ end_ds }}'\nGROUP BY\n  o.customer_id,\n  o.ds"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.order_items"", ""identifier"": ""2919798394""}, {""name"": ""sushi.items"", ""identifier"": ""815328819""}, {""name"": ""sushi.orders"", ""identifier"": ""2312765867""}], ""audits"": [], ""created_ts"": 1700274095387, ""updated_ts"": 1700274096407, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""2415394817"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.customer_revenue_lifetime,4247773602,2296753346,"{""name"": ""sushi.customer_revenue_lifetime"", ""fingerprint"": {""data_hash"": ""2901052276"", ""metadata_hash"": ""452428120"", ""parent_data_hash"": ""1473581816"", ""parent_metadata_hash"": ""1029038200""}, ""node"": {""name"": ""sushi.customer_revenue_lifetime"", ""project"": """", ""description"": ""Table of lifetime customer revenue.\n    Date is available to get lifetime value up to a certain date.\n    Use latest date to get current lifetime value."", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""hive"", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 1, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""columns"": {""customer_id"": ""INT"", ""revenue"": ""DOUBLE"", ""ds"": ""STRING""}, ""audits"": [], ""grains"": [""[customer_id, ds]""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""order_items"": {""id"": ""INT"", ""order_id"": ""INT"", ""item_id"": ""INT"", ""quantity"": ""INT"", ""ds"": ""STRING""}, ""items"": {""id"": ""INT"", ""name"": ""STRING"", ""price"": ""DOUBLE"", ""ds"": ""STRING""}, ""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""STRING""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""WITH order_total AS (\n  SELECT\n    oi.order_id AS order_id,\n    SUM(oi.quantity * i.price) AS total\n  FROM sushi.order_items AS oi\n  LEFT JOIN sushi.items AS i\n    ON oi.item_id = i.id AND oi.ds = i.ds\n  WHERE\n    oi.ds = @end_ds\n  GROUP BY\n    oi.order_id\n), incremental_total AS (\n  SELECT\n    o.customer_id::INT AS customer_id,\n    SUM(ot.total)::DOUBLE AS revenue,\n  FROM sushi.orders AS o\n  LEFT JOIN order_total AS ot\n    ON o.id = ot.order_id\n  WHERE\n    o.ds = @end_ds\n  GROUP BY\n    o.customer_id\n), prev_total AS (\n  SELECT\n    crl.customer_id,\n    crl.revenue\n  FROM sushi.customer_revenue_lifetime AS crl\n  WHERE\n    crl.ds = DATE_FORMAT(@end_date - INTERVAL 1 DAY, 'YYYY-MM-dd')\n)\nSELECT\n  COALESCE(it.customer_id, prev_total.customer_id) AS customer_id, /* Customer id */\n  COALESCE(it.revenue, 0) + COALESCE(prev_total.revenue, 0) AS revenue, /* Lifetime revenue from this customer */\n  @end_ds AS ds /* End date of the lifetime calculation */\nFROM incremental_total AS it\nFULL OUTER JOIN prev_total AS prev_total\n  ON it.customer_id = prev_total.customer_id"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.order_items"", ""identifier"": ""2919798394""}, {""name"": ""sushi.items"", ""identifier"": ""815328819""}, {""name"": ""sushi.orders"", ""identifier"": ""2312765867""}], ""audits"": [], ""created_ts"": 1700274095379, ""updated_ts"": 1700274096408, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""2296753346"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.customers,3678517880,137303981,"{""name"": ""sushi.customers"", ""fingerprint"": {""data_hash"": ""3180686416"", ""metadata_hash"": ""1779102911"", ""parent_data_hash"": ""3525147672"", ""parent_metadata_hash"": ""3424206008""}, ""node"": {""name"": ""sushi.customers"", ""project"": """", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [""pii"", ""fact""], ""dialect"": ""duckdb"", ""kind"": {""name"": ""FULL""}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [], ""grains"": [""customer_id""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""TEXT""}, ""marketing"": {""customer_id"": ""INT"", ""status"": ""TEXT"", ""updated_at"": ""TIMESTAMP"", ""valid_from"": ""TIMESTAMP"", ""valid_to"": ""TIMESTAMP""}}, ""raw"": {""demographics"": {""customer_id"": ""INT"", ""zip"": ""TEXT""}}}, ""pre_statements"": [""CREATE SCHEMA IF NOT EXISTS raw"", ""DROP TABLE IF EXISTS raw.demographics"", ""CREATE TABLE raw.demographics AS (\n  SELECT 1 AS customer_id, '00000' AS zip\n)""], ""post_statements"": [], ""query"": ""WITH current_marketing AS (\n  SELECT\n    customer_id,\n    status\n  FROM sushi.marketing\n  WHERE valid_to is null\n)\nSELECT DISTINCT\n  o.customer_id::INT AS customer_id,\n  m.status,\n  d.zip\nFROM sushi.orders AS o\nLEFT JOIN current_marketing AS m\n    ON o.customer_id = m.customer_id\nLEFT JOIN raw.demographics AS d\n    ON o.customer_id = d.customer_id"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.orders"", ""identifier"": ""2312765867""}, {""name"": ""raw.demographics"", ""identifier"": ""1140349482""}, {""name"": ""sushi.marketing"", ""identifier"": ""4121597394""}], ""audits"": [], ""created_ts"": 1700274095382, ""updated_ts"": 1700274096410, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""137303981"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",FULL
sushi.waiter_revenue_by_day,325013195,4067818408,"{""name"": ""sushi.waiter_revenue_by_day"", ""fingerprint"": {""data_hash"": ""1745707079"", ""metadata_hash"": ""4039894674"", ""parent_data_hash"": ""1473581816"", ""parent_metadata_hash"": ""1029038200""}, ""node"": {""name"": ""sushi.waiter_revenue_by_day"", ""project"": """", ""description"": ""Table of revenue generated by waiters by day."", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 10, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [[""number_of_rows"", {""threshold"": ""0""}]], ""grains"": [""(waiter_id, ds)""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""TEXT""}, ""items"": {""id"": ""INT"", ""name"": ""TEXT"", ""price"": ""DOUBLE"", ""ds"": ""TEXT""}, ""order_items"": {""id"": ""INT"", ""order_id"": ""INT"", ""item_id"": ""INT"", ""quantity"": ""INT"", ""ds"": ""TEXT""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""SELECT\n  o.waiter_id::INT AS waiter_id, /* Waiter id */\n  SUM(oi.quantity * i.price)::DOUBLE AS revenue, /* Revenue from orders taken by this waiter */\n  o.ds::TEXT AS ds /* Date */\nFROM sushi.orders AS o\nLEFT JOIN sushi.order_items AS oi\n  ON o.id = oi.order_id AND o.ds = oi.ds\nLEFT JOIN sushi.items AS i\n  ON oi.item_id = i.id AND oi.ds = i.ds\nWHERE\n  o.ds BETWEEN @start_ds AND @end_ds\nGROUP BY\n  o.waiter_id,\n  o.ds"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.orders"", ""identifier"": ""2312765867""}, {""name"": ""sushi.items"", ""identifier"": ""815328819""}, {""name"": ""sushi.order_items"", ""identifier"": ""2919798394""}], ""audits"": [], ""created_ts"": 1700274095367, ""updated_ts"": 1700274096411, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""4067818408"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.top_waiters,664765787,3880934108,"{""name"": ""sushi.top_waiters"", ""fingerprint"": {""data_hash"": ""107292750"", ""metadata_hash"": ""645077123"", ""parent_data_hash"": ""387206233"", ""parent_metadata_hash"": ""1365718626""}, ""node"": {""name"": ""sushi.top_waiters"", ""project"": """", ""description"": ""View of top waiters."", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""VIEW"", ""materialized"": false}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [[""unique_values"", {""columns"": ""ARRAY(waiter_id)""}]], ""grains"": [""waiter_id""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""waiter_revenue_by_day"": {""waiter_id"": ""INT"", ""revenue"": ""DOUBLE"", ""ds"": ""TEXT""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""SELECT\n  waiter_id::INT AS waiter_id,\n  revenue::DOUBLE AS revenue\nFROM sushi.waiter_revenue_by_day\nWHERE\n  ds = (\n    SELECT\n      MAX(ds)\n    FROM sushi.waiter_revenue_by_day\n  )\nORDER BY\n  revenue DESC\nLIMIT 10"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.waiter_revenue_by_day"", ""identifier"": ""325013195""}], ""audits"": [], ""created_ts"": 1700274095395, ""updated_ts"": 1700274096412, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""3880934108"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",VIEW
sushi.waiter_as_customer_by_day,2675451414,1695007643,"{""name"": ""sushi.waiter_as_customer_by_day"", ""fingerprint"": {""data_hash"": ""1791599530"", ""metadata_hash"": ""2880894715"", ""parent_data_hash"": ""471827824"", ""parent_metadata_hash"": ""1011099087""}, ""node"": {""name"": ""sushi.waiter_as_customer_by_day"", ""project"": """", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [[""not_null"", {""columns"": ""ARRAY(waiter_id)""}], [""forall"", {""criteria"": ""ARRAY(LENGTH(waiter_name) > 0)""}]], ""grains"": [], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {""identity"": {""definition"": ""{% macro identity(y) %}\n  {{ y }}\n{% endmacro %}"", ""depends_on"": []}, ""alias"": {""definition"": ""{% macro alias(expr, alias) %}\n  {{ expr }} AS {{ alias }}\n{% endmacro %}"", ""depends_on"": []}}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""waiters"": {""waiter_id"": ""INT"", ""ds"": ""TEXT""}, ""waiter_names"": {""id"": ""BIGINT"", ""name"": ""TEXT""}, ""customers"": {""customer_id"": ""INT"", ""status"": ""TEXT"", ""zip"": ""TEXT""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""JINJA_QUERY_BEGIN;\n\n{% set x = 1 %}\n\nSELECT\n  w.waiter_id as waiter_id,\n  wn.name as waiter_name,\n  {{ alias(identity(x), 'flag') }},\n  w.ds as ds\nFROM sushi.waiters AS w\nJOIN sushi.customers as c ON w.waiter_id = c.customer_id\nJOIN sushi.waiter_names as wn ON w.waiter_id = wn.id;\n\nJINJA_END"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.orders"", ""identifier"": ""2312765867""}, {""name"": ""sushi.waiters"", ""identifier"": ""1434975336""}, {""name"": ""sushi.waiter_names"", ""identifier"": ""2187544572""}, {""name"": ""sushi.customers"", ""identifier"": ""3678517880""}], ""audits"": [], ""created_ts"": 1700274095390, ""updated_ts"": 1700274096414, ""ttl"": ""in 1 week"", ""previous_versions"": [], ""indirect_versions"": {}, ""version"": ""1695007643"", ""change_category"": 1, ""unpaused_ts"": 1700265600000, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.waiter_revenue_by_day,3037872537,1171401943,"{""name"": ""sushi.waiter_revenue_by_day"", ""fingerprint"": {""data_hash"": ""607316666"", ""metadata_hash"": ""4039894674"", ""parent_data_hash"": ""1473581816"", ""parent_metadata_hash"": ""1029038200""}, ""node"": {""name"": ""sushi.waiter_revenue_by_day"", ""project"": """", ""description"": ""Table of revenue generated by waiters by day."", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""INCREMENTAL_BY_TIME_RANGE"", ""batch_size"": 10, ""forward_only"": false, ""disable_restatement"": false, ""time_column"": {""column"": ""ds"", ""format"": ""%Y-%m-%d""}}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [[""number_of_rows"", {""threshold"": ""0""}]], ""grains"": [""(waiter_id, ds)""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""orders"": {""id"": ""INT"", ""customer_id"": ""INT"", ""waiter_id"": ""INT"", ""start_ts"": ""INT"", ""end_ts"": ""INT"", ""ds"": ""TEXT""}, ""items"": {""id"": ""INT"", ""name"": ""TEXT"", ""price"": ""DOUBLE"", ""ds"": ""TEXT""}, ""order_items"": {""id"": ""INT"", ""order_id"": ""INT"", ""item_id"": ""INT"", ""quantity"": ""INT"", ""ds"": ""TEXT""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""SELECT CAST(o.waiter_id AS INT) AS waiter_id /* Waiter id */, CAST(SUM(oi.quantity * i.price) AS DOUBLE) AS revenue /* Revenue from orders taken by this waiter */, 'dummy' AS dummy_col, CAST(o.ds AS TEXT) AS ds /* Date */ FROM sushi.orders AS o LEFT JOIN sushi.order_items AS oi ON o.id = oi.order_id AND o.ds = oi.ds LEFT JOIN sushi.items AS i ON oi.item_id = i.id AND oi.ds = i.ds WHERE o.ds BETWEEN @start_ds AND @end_ds GROUP BY o.waiter_id, o.ds"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.orders"", ""identifier"": ""2312765867""}, {""name"": ""sushi.items"", ""identifier"": ""815328819""}, {""name"": ""sushi.order_items"", ""identifier"": ""2919798394""}], ""audits"": [], ""created_ts"": 1700274096557, ""updated_ts"": 1700274096557, ""ttl"": ""in 1 week"", ""previous_versions"": [{""fingerprint"": {""data_hash"": ""1745707079"", ""metadata_hash"": ""4039894674"", ""parent_data_hash"": ""1473581816"", ""parent_metadata_hash"": ""1029038200""}, ""version"": ""4067818408"", ""change_category"": 1, ""physical_schema"": ""sqlmesh__sushi""}], ""indirect_versions"": {""sushi.top_waiters"": [{""fingerprint"": {""data_hash"": ""107292750"", ""metadata_hash"": ""645077123"", ""parent_data_hash"": ""387206233"", ""parent_metadata_hash"": ""1365718626""}, ""version"": ""3880934108"", ""change_category"": 1, ""physical_schema"": ""sqlmesh__sushi""}, {""fingerprint"": {""data_hash"": ""107292750"", ""metadata_hash"": ""2770203649"", ""parent_data_hash"": ""2247135076"", ""parent_metadata_hash"": ""1365718626""}, ""version"": ""3880934108"", ""temp_version"": ""3880934108"", ""change_category"": 5, ""physical_schema"": ""sqlmesh__sushi""}]}, ""version"": ""1171401943"", ""change_category"": 2, ""migrated"": false, ""unrestorable"": false}",INCREMENTAL_BY_TIME_RANGE
sushi.top_waiters,1950798442,3880934108,"{""name"": ""sushi.top_waiters"", ""fingerprint"": {""data_hash"": ""107292750"", ""metadata_hash"": ""2770203649"", ""parent_data_hash"": ""2247135076"", ""parent_metadata_hash"": ""1365718626""}, ""physical_schema"": ""sqlmesh__sushi"", ""node"": {""name"": ""sushi.top_waiters"", ""project"": """", ""description"": ""View of top waiters."", ""owner"": ""jen"", ""cron"": ""@daily"", ""tags"": [], ""dialect"": ""duckdb"", ""kind"": {""name"": ""VIEW"", ""materialized"": false}, ""partitioned_by"": [], ""clustered_by"": [], ""audits"": [[""unique_values"", {""columns"": ""ARRAY(waiter_id)""}]], ""grains"": [""waiter_id""], ""references"": [], ""hash_raw_query"": false, ""allow_partials"": false, ""signals"": [], ""python_env"": {}, ""jinja_macros"": {""packages"": {}, ""root_macros"": {}, ""global_objs"": {""gateway"": """"}, ""top_level_packages"": []}, ""mapping_schema"": {""sushi"": {""waiter_revenue_by_day"": {""waiter_id"": ""INT"", ""revenue"": ""DOUBLE"", ""dummy_col"": ""TEXT"", ""ds"": ""TEXT""}}}, ""pre_statements"": [], ""post_statements"": [], ""query"": ""SELECT\n  waiter_id::INT AS waiter_id,\n  revenue::DOUBLE AS revenue\nFROM sushi.waiter_revenue_by_day\nWHERE\n  ds = (\n    SELECT\n      MAX(ds)\n    FROM sushi.waiter_revenue_by_day\n  )\nORDER BY\n  revenue DESC\nLIMIT 10"", ""source_type"": ""sql""}, ""parents"": [{""name"": ""sushi.waiter_revenue_by_day"", ""identifier"": ""3037872537""}], ""audits"": [], ""created_ts"": 1700274096575, ""updated_ts"": 1700274096575, ""ttl"": ""in 1 week"", ""previous_versions"": [{""fingerprint"": {""data_hash"": ""107292750"", ""metadata_hash"": ""645077123"", ""parent_data_hash"": ""387206233"", ""parent_metadata_hash"": ""1365718626""}, ""version"": ""3880934108"", ""change_category"": 1, ""physical_schema"": ""sqlmesh__sushi""}], ""indirect_versions"": {}, ""version"": ""3880934108"", ""temp_version"": ""3880934108"", ""change_category"": 5, ""migrated"": false, ""unrestorable"": false}",VIEW
